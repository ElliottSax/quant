<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quant Analytics - Advanced Platform</title>
    
    <!-- Stylesheets -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Libraries -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts@3.44.0/dist/apexcharts.min.js"></script>
    <script src="https://unpkg.com/three@0.157.0/build/three.min.js"></script>
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        
        /* Animated background */
        .bg-animated {
            background: linear-gradient(-45deg, #0f172a, #1e293b, #334155, #1e293b);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Floating particles */
        .particle {
            position: absolute;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 50%;
            pointer-events: none;
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }
        
        /* Glass morphism */
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        
        /* Neon glow effects */
        .neon-blue { box-shadow: 0 0 20px #3b82f6; }
        .neon-purple { box-shadow: 0 0 20px #8b5cf6; }
        .neon-green { box-shadow: 0 0 20px #10b981; }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1f2937; }
        ::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #6b7280; }
        
        /* Chart containers */
        .chart-container {
            position: relative;
            height: 400px;
            background: rgba(17, 24, 39, 0.8);
            border-radius: 12px;
            padding: 20px;
        }
        
        /* Loading animations */
        .pulse-glow {
            animation: pulseGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes pulseGlow {
            from { box-shadow: 0 0 10px #3b82f6; }
            to { box-shadow: 0 0 30px #3b82f6; }
        }
        
        /* Interactive elements */
        .interactive-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .interactive-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        /* Search input */
        .search-input {
            background: rgba(17, 24, 39, 0.9);
            border: 1px solid rgba(59, 130, 246, 0.3);
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }
    </style>
</head>
<body class="bg-gray-900 text-white overflow-x-hidden">
    <!-- Animated Background -->
    <div class="fixed inset-0 bg-animated -z-10"></div>
    
    <!-- Floating Particles -->
    <div id="particles" class="fixed inset-0 pointer-events-none -z-5"></div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass backdrop-blur-lg">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-chart-line text-white text-xl"></i>
                    </div>
                    <h1 class="text-2xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
                        Quant Analytics
                    </h1>
                </div>
                <div class="hidden md:flex items-center space-x-6">
                    <a href="#dashboard" class="hover:text-blue-400 transition duration-300">Dashboard</a>
                    <a href="#analytics" class="hover:text-blue-400 transition duration-300">Analytics</a>
                    <a href="#tools" class="hover:text-blue-400 transition duration-300">Tools</a>
                    <div class="flex space-x-3">
                        <button id="loginBtn" class="bg-blue-600 hover:bg-blue-500 px-4 py-2 rounded-lg transition duration-300">
                            Login
                        </button>
                        <button id="registerBtn" class="bg-purple-600 hover:bg-purple-500 px-4 py-2 rounded-lg transition duration-300">
                            Register
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="min-h-screen flex items-center justify-center relative pt-20">
        <div class="max-w-7xl mx-auto px-6 text-center">
            <!-- Main Content -->
            <div class="mb-12">
                <h1 class="text-7xl md:text-8xl font-bold mb-6 leading-tight">
                    <span class="bg-gradient-to-r from-blue-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent">
                        Congressional
                    </span>
                    <br>
                    <span class="text-white">Trading Analytics</span>
                </h1>
                <p class="text-2xl text-gray-300 mb-8 max-w-4xl mx-auto leading-relaxed">
                    Advanced machine learning platform for analyzing political stock trades with 
                    <span class="text-blue-400 font-semibold">real-time insights</span>, 
                    <span class="text-purple-400 font-semibold">pattern detection</span>, and 
                    <span class="text-cyan-400 font-semibold">predictive analytics</span>
                </p>
                
                <!-- Action Buttons -->
                <div class="flex flex-col sm:flex-row gap-6 justify-center mb-12">
                    <button id="startAnalysisBtn" class="group bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 px-8 py-4 rounded-xl text-lg font-semibold transition duration-300 transform hover:scale-105 neon-blue">
                        <i class="fas fa-rocket mr-3"></i>
                        Start Analysis
                        <i class="fas fa-arrow-right ml-3 group-hover:translate-x-1 transition duration-300"></i>
                    </button>
                    <button id="exploreDemoBtn" class="group glass px-8 py-4 rounded-xl text-lg font-semibold transition duration-300 transform hover:scale-105 border border-gray-600 hover:border-blue-400">
                        <i class="fas fa-play mr-3"></i>
                        View Demo
                        <i class="fas fa-external-link-alt ml-3 opacity-0 group-hover:opacity-100 transition duration-300"></i>
                    </button>
                </div>
            </div>

            <!-- Live Stats Dashboard -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
                <div class="glass p-6 rounded-xl interactive-card">
                    <div class="text-3xl font-bold text-blue-400 mb-2" id="liveApiStatus">
                        <i class="fas fa-heartbeat pulse-glow"></i>
                    </div>
                    <p class="text-sm text-gray-400">API Status</p>
                </div>
                <div class="glass p-6 rounded-xl interactive-card">
                    <div class="text-3xl font-bold text-green-400 mb-2" id="livePoliticianCount">247</div>
                    <p class="text-sm text-gray-400">Politicians Tracked</p>
                </div>
                <div class="glass p-6 rounded-xl interactive-card">
                    <div class="text-3xl font-bold text-purple-400 mb-2" id="liveTradeVolume">$2.4B</div>
                    <p class="text-sm text-gray-400">Trade Volume</p>
                </div>
                <div class="glass p-6 rounded-xl interactive-card">
                    <div class="text-3xl font-bold text-cyan-400 mb-2" id="liveResponseTime">23ms</div>
                    <p class="text-sm text-gray-400">Response Time</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Advanced Dashboard Section -->
    <section id="dashboard" class="py-20 relative">
        <div class="max-w-7xl mx-auto px-6">
            <!-- Search and Filters -->
            <div class="mb-12">
                <div class="flex flex-col lg:flex-row gap-6 items-center justify-between">
                    <div class="flex-1 max-w-2xl">
                        <div class="relative">
                            <input 
                                type="text" 
                                id="politicianSearch" 
                                placeholder="Search politicians, sectors, or tickers..."
                                class="w-full px-6 py-4 rounded-xl search-input text-white placeholder-gray-400 pr-12"
                            >
                            <i class="fas fa-search absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        </div>
                    </div>
                    <div class="flex gap-4">
                        <select id="partyFilter" class="px-4 py-3 rounded-lg glass border border-gray-600">
                            <option value="">All Parties</option>
                            <option value="Democratic">Democratic</option>
                            <option value="Republican">Republican</option>
                        </select>
                        <select id="chamberFilter" class="px-4 py-3 rounded-lg glass border border-gray-600">
                            <option value="">All Chambers</option>
                            <option value="House">House</option>
                            <option value="Senate">Senate</option>
                        </select>
                        <button id="exportBtn" class="bg-green-600 hover:bg-green-500 px-6 py-3 rounded-lg transition duration-300">
                            <i class="fas fa-download mr-2"></i>
                            Export
                        </button>
                    </div>
                </div>
            </div>

            <!-- Interactive Charts Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
                <!-- Trading Volume Chart -->
                <div class="glass p-6 rounded-xl">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold">Trading Volume Over Time</h3>
                        <div class="flex gap-2">
                            <button class="text-xs px-3 py-1 bg-blue-600 rounded active">1W</button>
                            <button class="text-xs px-3 py-1 bg-gray-700 rounded">1M</button>
                            <button class="text-xs px-3 py-1 bg-gray-700 rounded">3M</button>
                            <button class="text-xs px-3 py-1 bg-gray-700 rounded">1Y</button>
                        </div>
                    </div>
                    <div id="volumeChart" class="chart-container"></div>
                </div>

                <!-- Top Politicians by Volume -->
                <div class="glass p-6 rounded-xl">
                    <h3 class="text-xl font-bold mb-4">Top Politicians by Volume</h3>
                    <div id="topPoliticiansChart" class="chart-container"></div>
                </div>

                <!-- Sector Distribution -->
                <div class="glass p-6 rounded-xl">
                    <h3 class="text-xl font-bold mb-4">Sector Distribution</h3>
                    <div id="sectorChart" class="chart-container"></div>
                </div>

                <!-- Pattern Detection -->
                <div class="glass p-6 rounded-xl">
                    <h3 class="text-xl font-bold mb-4">Anomaly Detection</h3>
                    <div id="anomalyChart" class="chart-container"></div>
                </div>
            </div>

            <!-- Advanced Analytics Tools -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Network Analysis Tool -->
                <div class="glass p-6 rounded-xl interactive-card">
                    <div class="text-center mb-4">
                        <div class="w-16 h-16 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-project-diagram text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold">Network Analysis</h3>
                        <p class="text-gray-400 text-sm mb-4">Discover connections between politicians' trading patterns</p>
                    </div>
                    <button id="networkAnalysisBtn" class="w-full bg-gradient-to-r from-blue-600 to-cyan-600 py-3 rounded-lg font-semibold hover:from-blue-500 hover:to-cyan-500 transition duration-300">
                        Analyze Network
                    </button>
                </div>

                <!-- Pattern Detection Tool -->
                <div class="glass p-6 rounded-xl interactive-card">
                    <div class="text-center mb-4">
                        <div class="w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-search-plus text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold">Pattern Detection</h3>
                        <p class="text-gray-400 text-sm mb-4">Find cyclical and seasonal trading patterns</p>
                    </div>
                    <button id="patternDetectionBtn" class="w-full bg-gradient-to-r from-purple-600 to-pink-600 py-3 rounded-lg font-semibold hover:from-purple-500 hover:to-pink-500 transition duration-300">
                        Detect Patterns
                    </button>
                </div>

                <!-- Prediction Engine -->
                <div class="glass p-6 rounded-xl interactive-card">
                    <div class="text-center mb-4">
                        <div class="w-16 h-16 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-crystal-ball text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold">Prediction Engine</h3>
                        <p class="text-gray-400 text-sm mb-4">ML-powered trading behavior predictions</p>
                    </div>
                    <button id="predictionEngineBtn" class="w-full bg-gradient-to-r from-green-600 to-emerald-600 py-3 rounded-lg font-semibold hover:from-green-500 hover:to-emerald-500 transition duration-300">
                        Run Predictions
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Network Visualization Modal -->
    <div id="networkModal" class="fixed inset-0 bg-black bg-opacity-80 hidden items-center justify-center z-50">
        <div class="glass p-8 rounded-2xl w-11/12 h-5/6 max-w-6xl">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">Network Analysis</h2>
                <button id="closeNetworkModal" class="text-gray-400 hover:text-white">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <div id="networkViz" class="w-full h-full bg-gray-900 rounded-xl relative overflow-hidden">
                <div class="absolute inset-0 flex items-center justify-center">
                    <div class="text-center">
                        <i class="fas fa-spinner fa-spin text-4xl text-blue-400 mb-4"></i>
                        <p class="text-gray-400">Generating network visualization...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Real-time Data Feed -->
    <div id="dataFeed" class="fixed bottom-6 right-6 glass p-4 rounded-xl w-80 max-h-96 overflow-y-auto">
        <div class="flex items-center justify-between mb-3">
            <h4 class="font-bold text-sm">Real-time Feed</h4>
            <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
        </div>
        <div id="feedContent" class="space-y-2 text-xs">
            <!-- Live updates will appear here -->
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        const API_BASE = 'http://localhost:8000';
        const API_V1 = `${API_BASE}/api/v1`;
        let authToken = localStorage.getItem('authToken');
        let charts = {};

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
            initializeCharts();
            startRealTimeUpdates();
            bindEventListeners();
            loadInitialData();
        });

        // Create floating particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 50;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.width = Math.random() * 4 + 2 + 'px';
                particle.style.height = particle.style.width;
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Initialize all charts
        function initializeCharts() {
            // Trading Volume Chart
            const volumeCtx = document.getElementById('volumeChart');
            if (volumeCtx) {
                const volumeChart = new ApexCharts(volumeCtx, {
                    chart: {
                        type: 'area',
                        height: 350,
                        background: 'transparent',
                        animations: { enabled: true },
                        toolbar: { show: false }
                    },
                    colors: ['#3b82f6', '#8b5cf6'],
                    series: [{
                        name: 'Volume',
                        data: generateSampleData(30)
                    }],
                    xaxis: {
                        categories: generateDateLabels(30),
                        labels: { style: { colors: '#9ca3af' } }
                    },
                    yaxis: {
                        labels: { 
                            style: { colors: '#9ca3af' },
                            formatter: function(val) {
                                return '$' + (val / 1000000).toFixed(1) + 'M';
                            }
                        }
                    },
                    grid: { borderColor: '#374151' },
                    fill: {
                        type: 'gradient',
                        gradient: {
                            shadeIntensity: 1,
                            stops: [0, 90, 100],
                            colorStops: [
                                { offset: 0, color: '#3b82f6', opacity: 0.8 },
                                { offset: 100, color: '#3b82f6', opacity: 0.1 }
                            ]
                        }
                    },
                    stroke: { curve: 'smooth', width: 3 }
                });
                volumeChart.render();
                charts.volume = volumeChart;
            }

            // Top Politicians Chart
            const topPoliticiansCtx = document.getElementById('topPoliticiansChart');
            if (topPoliticiansCtx) {
                const topPoliticiansChart = new ApexCharts(topPoliticiansCtx, {
                    chart: {
                        type: 'bar',
                        height: 350,
                        background: 'transparent',
                        toolbar: { show: false }
                    },
                    colors: ['#10b981', '#f59e0b', '#ef4444'],
                    series: [{
                        data: [
                            { x: 'Nancy Pelosi', y: 45000000 },
                            { x: 'Richard Burr', y: 32000000 },
                            { x: 'Kelly Loeffler', y: 28000000 },
                            { x: 'David Perdue', y: 25000000 },
                            { x: 'Dan Crenshaw', y: 22000000 }
                        ]
                    }],
                    plotOptions: {
                        bar: { horizontal: true, borderRadius: 8 }
                    },
                    xaxis: {
                        labels: { 
                            style: { colors: '#9ca3af' },
                            formatter: function(val) {
                                return '$' + (val / 1000000).toFixed(0) + 'M';
                            }
                        }
                    },
                    yaxis: {
                        labels: { style: { colors: '#9ca3af' } }
                    },
                    grid: { borderColor: '#374151' }
                });
                topPoliticiansChart.render();
                charts.topPoliticians = topPoliticiansChart;
            }

            // Sector Distribution Chart
            const sectorCtx = document.getElementById('sectorChart');
            if (sectorCtx) {
                const sectorChart = new ApexCharts(sectorCtx, {
                    chart: {
                        type: 'donut',
                        height: 350,
                        background: 'transparent'
                    },
                    colors: ['#3b82f6', '#8b5cf6', '#10b981', '#f59e0b', '#ef4444'],
                    series: [35, 25, 20, 15, 5],
                    labels: ['Technology', 'Healthcare', 'Finance', 'Energy', 'Other'],
                    legend: {
                        labels: { colors: '#9ca3af' },
                        position: 'bottom'
                    },
                    plotOptions: {
                        pie: {
                            donut: {
                                size: '70%',
                                labels: {
                                    show: true,
                                    total: {
                                        show: true,
                                        color: '#ffffff'
                                    }
                                }
                            }
                        }
                    }
                });
                sectorChart.render();
                charts.sector = sectorChart;
            }

            // Anomaly Chart
            const anomalyCtx = document.getElementById('anomalyChart');
            if (anomalyCtx) {
                const anomalyChart = new ApexCharts(anomalyCtx, {
                    chart: {
                        type: 'scatter',
                        height: 350,
                        background: 'transparent',
                        toolbar: { show: false }
                    },
                    colors: ['#ef4444', '#10b981'],
                    series: [
                        {
                            name: 'Normal',
                            data: generateScatterData(100, 0.2)
                        },
                        {
                            name: 'Anomaly',
                            data: generateScatterData(10, 0.8)
                        }
                    ],
                    xaxis: {
                        title: { text: 'Trade Volume', style: { color: '#9ca3af' } },
                        labels: { style: { colors: '#9ca3af' } }
                    },
                    yaxis: {
                        title: { text: 'Timing Score', style: { color: '#9ca3af' } },
                        labels: { style: { colors: '#9ca3af' } }
                    },
                    grid: { borderColor: '#374151' },
                    markers: { size: 6 }
                });
                anomalyChart.render();
                charts.anomaly = anomalyChart;
            }
        }

        // Generate sample data
        function generateSampleData(points) {
            const data = [];
            let value = 1000000;
            for (let i = 0; i < points; i++) {
                value += (Math.random() - 0.5) * 200000;
                data.push(Math.max(0, value));
            }
            return data;
        }

        function generateDateLabels(points) {
            const labels = [];
            const today = new Date();
            for (let i = points - 1; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                labels.push(date.toLocaleDateString());
            }
            return labels;
        }

        function generateScatterData(points, anomalyFactor) {
            const data = [];
            for (let i = 0; i < points; i++) {
                data.push([
                    Math.random() * 1000000 * (1 + anomalyFactor),
                    Math.random() * 100 * (1 + anomalyFactor)
                ]);
            }
            return data;
        }

        // Real-time updates
        function startRealTimeUpdates() {
            updateLiveStats();
            updateRealTimeFeed();
            
            // Update every 5 seconds
            setInterval(() => {
                updateLiveStats();
                updateRealTimeFeed();
            }, 5000);
        }

        async function updateLiveStats() {
            try {
                const start = Date.now();
                const response = await axios.get(`${API_BASE}/health`);
                const responseTime = Date.now() - start;
                
                document.getElementById('liveApiStatus').innerHTML = '<i class="fas fa-check-circle text-green-400"></i>';
                document.getElementById('liveResponseTime').textContent = responseTime + 'ms';
                
                // Simulate live data updates
                updateCounter('livePoliticianCount', 245, 250);
                updateCounter('liveTradeVolume', 2.3, 2.5, 'B');
            } catch (error) {
                document.getElementById('liveApiStatus').innerHTML = '<i class="fas fa-exclamation-triangle text-red-400"></i>';
            }
        }

        function updateCounter(elementId, min, max, suffix = '') {
            const element = document.getElementById(elementId);
            const current = parseFloat(element.textContent);
            const target = min + Math.random() * (max - min);
            const formatted = suffix === 'B' ? '$' + target.toFixed(1) + suffix : Math.floor(target);
            element.textContent = formatted;
        }

        function updateRealTimeFeed() {
            const feedContent = document.getElementById('feedContent');
            const messages = [
                'Nancy Pelosi: New NVDA trade detected',
                'Richard Burr: Healthcare sector activity',
                'Pattern detected: Tech stock clustering',
                'Anomaly alert: Unusual after-hours trading',
                'New user registered: @analyst_pro',
                'API rate limit: 85% capacity'
            ];
            
            const message = messages[Math.floor(Math.random() * messages.length)];
            const time = new Date().toLocaleTimeString();
            
            const feedItem = document.createElement('div');
            feedItem.className = 'text-gray-300 p-2 bg-gray-800 rounded text-xs';
            feedItem.innerHTML = `<span class="text-blue-400">${time}</span> ${message}`;
            
            feedContent.insertBefore(feedItem, feedContent.firstChild);
            
            // Keep only last 10 items
            while (feedContent.children.length > 10) {
                feedContent.removeChild(feedContent.lastChild);
            }
        }

        // Event listeners
        function bindEventListeners() {
            // Search functionality
            document.getElementById('politicianSearch').addEventListener('input', debounce(handleSearch, 300));
            
            // Filter functionality
            document.getElementById('partyFilter').addEventListener('change', handleFilters);
            document.getElementById('chamberFilter').addEventListener('change', handleFilters);
            
            // Tool buttons
            document.getElementById('networkAnalysisBtn').addEventListener('click', openNetworkAnalysis);
            document.getElementById('patternDetectionBtn').addEventListener('click', runPatternDetection);
            document.getElementById('predictionEngineBtn').addEventListener('click', runPredictions);
            
            // Modal controls
            document.getElementById('closeNetworkModal').addEventListener('click', closeNetworkModal);
            
            // Export functionality
            document.getElementById('exportBtn').addEventListener('click', exportData);
            
            // Hero buttons
            document.getElementById('startAnalysisBtn').addEventListener('click', () => {
                document.getElementById('dashboard').scrollIntoView({ behavior: 'smooth' });
            });
            
            document.getElementById('exploreDemoBtn').addEventListener('click', () => {
                window.open(`${API_V1}/docs`, '_blank');
            });
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function handleSearch(event) {
            const query = event.target.value.toLowerCase();
            console.log('Searching for:', query);
            // Implement real search functionality here
        }

        function handleFilters() {
            const party = document.getElementById('partyFilter').value;
            const chamber = document.getElementById('chamberFilter').value;
            console.log('Filtering by:', { party, chamber });
            // Implement real filtering here
        }

        async function openNetworkAnalysis() {
            const modal = document.getElementById('networkModal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            // Simulate network analysis
            setTimeout(() => {
                createNetworkVisualization();
            }, 2000);
        }

        function closeNetworkModal() {
            document.getElementById('networkModal').classList.add('hidden');
            document.getElementById('networkModal').classList.remove('flex');
        }

        function createNetworkVisualization() {
            const container = document.getElementById('networkViz');
            container.innerHTML = '';
            
            // Create D3 network visualization
            const svg = d3.select(container)
                .append('svg')
                .attr('width', container.clientWidth)
                .attr('height', container.clientHeight);
            
            const nodes = [
                { id: 'Pelosi', group: 1, value: 100 },
                { id: 'Burr', group: 2, value: 80 },
                { id: 'Loeffler', group: 2, value: 90 },
                { id: 'Crenshaw', group: 1, value: 70 }
            ];
            
            const links = [
                { source: 'Pelosi', target: 'Burr', value: 5 },
                { source: 'Burr', target: 'Loeffler', value: 8 },
                { source: 'Loeffler', target: 'Crenshaw', value: 3 }
            ];
            
            const simulation = d3.forceSimulation(nodes)
                .force('link', d3.forceLink(links).id(d => d.id))
                .force('charge', d3.forceManyBody().strength(-300))
                .force('center', d3.forceCenter(container.clientWidth / 2, container.clientHeight / 2));
            
            const link = svg.append('g')
                .selectAll('line')
                .data(links)
                .enter().append('line')
                .attr('stroke', '#3b82f6')
                .attr('stroke-width', d => Math.sqrt(d.value));
            
            const node = svg.append('g')
                .selectAll('circle')
                .data(nodes)
                .enter().append('circle')
                .attr('r', d => d.value / 5)
                .attr('fill', d => d.group === 1 ? '#3b82f6' : '#8b5cf6')
                .call(d3.drag()
                    .on('start', dragstarted)
                    .on('drag', dragged)
                    .on('end', dragended));
            
            const text = svg.append('g')
                .selectAll('text')
                .data(nodes)
                .enter().append('text')
                .text(d => d.id)
                .attr('fill', 'white')
                .attr('text-anchor', 'middle')
                .attr('dy', 5);
            
            simulation.on('tick', () => {
                link
                    .attr('x1', d => d.source.x)
                    .attr('y1', d => d.source.y)
                    .attr('x2', d => d.target.x)
                    .attr('y2', d => d.target.y);
                
                node
                    .attr('cx', d => d.x)
                    .attr('cy', d => d.y);
                
                text
                    .attr('x', d => d.x)
                    .attr('y', d => d.y);
            });
            
            function dragstarted(event, d) {
                if (!event.active) simulation.alphaTarget(0.3).restart();
                d.fx = d.x;
                d.fy = d.y;
            }
            
            function dragged(event, d) {
                d.fx = event.x;
                d.fy = event.y;
            }
            
            function dragended(event, d) {
                if (!event.active) simulation.alphaTarget(0);
                d.fx = null;
                d.fy = null;
            }
        }

        function runPatternDetection() {
            // Simulate pattern detection
            const button = document.getElementById('patternDetectionBtn');
            const originalText = button.innerHTML;
            
            button.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Detecting...';
            button.disabled = true;
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.disabled = false;
                
                // Show results
                alert('Patterns detected:\n- 30-day cyclical pattern in tech stocks\n- Seasonal bias toward healthcare Q4\n- Correlation cluster: Defense contractors');
            }, 3000);
        }

        function runPredictions() {
            // Simulate ML predictions
            const button = document.getElementById('predictionEngineBtn');
            const originalText = button.innerHTML;
            
            button.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Predicting...';
            button.disabled = true;
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.disabled = false;
                
                // Show results
                alert('Predictions:\n- 73% probability of increased tech trading next week\n- Anomaly likelihood: 12%\n- Optimal entry points identified');
            }, 4000);
        }

        function exportData() {
            const data = {
                politicians: 247,
                trades: 15000,
                volume: 2400000000,
                timestamp: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'quant_analytics_export.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        async function loadInitialData() {
            try {
                // Load real data from API
                const politicians = await axios.get(`${API_V1}/politicians/?limit=10`);
                console.log('Loaded politicians:', politicians.data.length);
            } catch (error) {
                console.log('Using mock data - API not available');
            }
        }
    </script>
</body>
</html>