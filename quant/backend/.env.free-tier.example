# ========================================
# FREE TIER ENVIRONMENT CONFIGURATION
# ========================================
# Copy this to .env and fill in your free service credentials
# Total Monthly Cost: $0
# ========================================

# ========================================
# BASIC CONFIGURATION
# ========================================
ENVIRONMENT=production
DEBUG=false
PROJECT_NAME="Quant Analytics Platform"
VERSION="1.0.0"
API_V1_STR="/api/v1"

# ========================================
# SECURITY (REQUIRED)
# ========================================
# Generate with: openssl rand -base64 32
SECRET_KEY=your-secret-key-min-32-chars-change-this-value
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# ========================================
# DATABASE: Supabase PostgreSQL (FREE)
# ========================================
# Get from: https://supabase.com/dashboard → Settings → Database
# Format: postgresql://postgres:[password]@[host]:5432/postgres
DATABASE_URL=postgresql://postgres.xxxxx:password@aws-0-us-west-1.pooler.supabase.com:5432/postgres

# Async variant (auto-constructed from DATABASE_URL)
# No need to set this - it's auto-generated

# ========================================
# REDIS: Upstash (FREE)
# ========================================
# Get from: https://console.upstash.com → Create Database → Copy REST URL
# Format: rediss://default:password@host:6379

# Main Redis (token blacklist, sessions)
REDIS_URL=rediss://default:xxxxx@us1-gentle-possum-12345.upstash.io:6379

# ML Redis (optional, can use same as REDIS_URL)
REDIS_ML_URL=rediss://default:xxxxx@us1-gentle-possum-12345.upstash.io:6379

# ========================================
# CORS: Vercel Frontend URL
# ========================================
# Update after deploying to Vercel
BACKEND_CORS_ORIGINS=https://your-app.vercel.app,http://localhost:3000,http://localhost:8000

# ========================================
# OBJECT STORAGE: Cloudflare R2 (FREE)
# ========================================
# Get from: Cloudflare Dashboard → R2 → Manage R2 API Tokens
# https://dash.cloudflare.com/

# S3-Compatible Configuration
AWS_ACCESS_KEY_ID=your-r2-access-key-id
AWS_SECRET_ACCESS_KEY=your-r2-secret-access-key
AWS_DEFAULT_REGION=auto
AWS_S3_ENDPOINT_URL=https://[account-id].r2.cloudflarestorage.com

# MLflow Artifact Storage (uses R2)
MLFLOW_ARTIFACT_BUCKET=mlflow-artifacts
MLFLOW_ARTIFACT_ROOT=s3://mlflow-artifacts

# Alternative: Use Supabase Storage (1GB free)
# SUPABASE_STORAGE_URL=https://[project].supabase.co/storage/v1
# SUPABASE_STORAGE_KEY=your-service-role-key

# ========================================
# MLFLOW TRACKING (OPTIONAL)
# ========================================
# Option 1: Run MLflow in Railway (adds ~$2-3/month)
# MLFLOW_TRACKING_URI=http://localhost:5000

# Option 2: Use Dagshub (FREE tier, 10GB)
# MLFLOW_TRACKING_URI=https://dagshub.com/[username]/[repo].mlflow
# MLFLOW_TRACKING_USERNAME=your-dagshub-username
# MLFLOW_TRACKING_PASSWORD=your-dagshub-token

# Option 3: Disable MLflow (use local file storage)
MLFLOW_TRACKING_URI=file:///app/mlruns

# Experiment Name
MLFLOW_EXPERIMENT_NAME=politician-trade-prediction

# ========================================
# MONITORING: Sentry (FREE)
# ========================================
# Get from: https://sentry.io → Settings → Projects → Client Keys (DSN)
# FREE tier: 5K errors/month
SENTRY_DSN=https://xxx@xxx.ingest.sentry.io/xxx
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# ========================================
# EMAIL: Resend (FREE)
# ========================================
# Get from: https://resend.com/api-keys
# FREE tier: 100 emails/day
RESEND_API_KEY=re_xxxxxxxxxxxx
EMAIL_FROM=noreply@yourdomain.com

# ========================================
# CELERY (OPTIONAL - for background tasks)
# ========================================
# Use Upstash Redis for Celery broker
CELERY_BROKER_URL=rediss://default:xxxxx@us1-gentle-possum-12345.upstash.io:6379
CELERY_RESULT_BACKEND=rediss://default:xxxxx@us1-gentle-possum-12345.upstash.io:6379

# ========================================
# RATE LIMITING
# ========================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000

# ========================================
# LOGGING
# ========================================
LOG_LEVEL=INFO
LOG_FORMAT=json

# Send logs to Better Stack (FREE 1GB/month)
# LOGTAIL_SOURCE_TOKEN=your-logtail-token

# ========================================
# FEATURE FLAGS
# ========================================
ENABLE_ML_ENDPOINTS=true
ENABLE_AUDIT_LOGGING=true
ENABLE_RATE_LIMITING=true
ENABLE_CACHING=true

# ========================================
# FREE TIER LIMITS & OPTIMIZATIONS
# ========================================
# Set conservative limits to stay within free tiers

# Database: Supabase 500MB limit
MAX_DB_CONNECTIONS=10
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10

# Redis: Upstash 10K commands/day limit
CACHE_TTL_DEFAULT=3600
CACHE_TTL_MAX=86400

# API: Railway $5 credit (~750MB RAM, 0.5 vCPU)
MAX_WORKERS=2
WORKER_TIMEOUT=30
MAX_REQUESTS_PER_WORKER=1000

# ========================================
# OPTIONAL: Analytics
# ========================================
# PostHog (FREE tier, 1M events/month)
# POSTHOG_API_KEY=phc_xxxxxxxxxxxx
# POSTHOG_HOST=https://app.posthog.com

# Google Analytics
# GA_MEASUREMENT_ID=G-XXXXXXXXXX

# ========================================
# DEPLOYMENT INFO
# ========================================
# Railway sets these automatically
# PORT=8000
# RAILWAY_ENVIRONMENT=production
# RAILWAY_PROJECT_ID=xxxxx
# RAILWAY_SERVICE_ID=xxxxx

# ========================================
# FREE TIER CHECKLIST
# ========================================
# ✅ Supabase PostgreSQL (500MB): https://supabase.com
# ✅ Upstash Redis (10K cmds/day): https://upstash.com
# ✅ Cloudflare R2 (10GB): https://dash.cloudflare.com
# ✅ Railway Backend ($5/mo credit): https://railway.app
# ✅ Vercel Frontend (100GB bandwidth): https://vercel.com
# ✅ Sentry Monitoring (5K errors): https://sentry.io
# ✅ Resend Email (100/day): https://resend.com
# ⚠️ Total Cost: $0/month
# ========================================
